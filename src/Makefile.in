# @configure_input@

# Package-specific substitution variables
package = @PACKAGE_NAME@
version = @PACKAGE_VERSION@
tarname = @PACKAGE_TARNAME@

prefix = @prefix@
exec_prefix = @exec_prefix@
bindir = @bindir@
datarootdir =@datarootdir@ 
mandir = @mandir@
man1dir = $(mandir)/man1


CC = gcc
CFLAGS = -Wall -std=c99 -O3 -DNDEBUG
LDFLAGS = -lm

INC=-I. -I.. -DHAVE_CONFIG_H

objects = cpu.o sidreloc.o solver.o

all: sidreloc

%.o : %.c
	$(CC) $(INC) $(CPPFLAGS) $(CFLAGS) -c $< -o $@

sidreloc: $(objects)
		${CC} -o $@ ${LDFLAGS} $(objects)

check: all
	@./sidreloc --version | grep "sidreloc $(version)"
	@echo "*** ALL TESTS PASSED ***"

install: all
	install -d $(DESTDIR)$(bindir)
	install -m 0755 sidreloc $(DESTDIR)$(bindir)
	mkdir -p $(man1dir)
	cp sidreloc.1 $(man1dir)

uninstall:
	-rm $(DESTDIR)$(bindir)/sidreloc

clean:
		@rm -rf *.o sidreloc

Makefile: Makefile.in ../config.status
	cd .. && ./config.status $@

../config.status: ../configure
	cd .. && ./config.status --recheck

.PHONY:	all clean check install uninstall